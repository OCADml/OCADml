<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Poly2 (OCADml.OCADml.Poly2)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">OCADml</a> &#x00BB; <a href="../index.html">OCADml</a> &#x00BB; Poly2</nav><header class="odoc-preamble"><h1>Module <code><span>OCADml.Poly2</span></code></h1><p>2d polygons made up of an outer, and zero or more inner <a href="../Path2/index.html#type-t"><code>Path2.t</code></a>s. Includes basic shape creation helpers, manipulations, (including offset and basic transformations), measurement, and validation.</p></header><nav class="odoc-toc"><ul><li><a href="#creation-and-validation">Creation and Validation</a></li><li><a href="#basic-shapes">Basic Shapes</a></li><li><a href="#geometry">Geometry</a></li><li><a href="#offset-and-basic-transformations">Offset and Basic Transformations</a></li></ul></nav><div class="odoc-content"><div class="odoc-spec"><div class="spec type" id="type-invalid" class="anchored"><a href="#type-invalid" class="anchor"></a><code><span><span class="keyword">type</span> invalid</span><span> = </span><span>[ </span></code><table><tr id="type-invalid.SelfIntersection" class="anchored"><td class="def constructor"><a href="#type-invalid.SelfIntersection" class="anchor"></a><code><span>| </span></code><code><span>`SelfIntersection <span class="keyword">of</span> int</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Raised during polygon validation if a path is found to self-intersect. The index refers to the culprit path (outer = <code>0</code>, with holes increasing).</p><span class="comment-delim">*)</span></td></tr><tr id="type-invalid.CrossIntersection" class="anchored"><td class="def constructor"><a href="#type-invalid.CrossIntersection" class="anchor"></a><code><span>| </span></code><code><span>`CrossIntersection <span class="keyword">of</span> int * int</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Raised during polygon validation if two paths are found to intersect eachother. The indices refer to the paths in question (outer = <code>0</code>, with holes increasing).</p><span class="comment-delim">*)</span></td></tr><tr id="type-invalid.DuplicatePoints" class="anchored"><td class="def constructor"><a href="#type-invalid.DuplicatePoints" class="anchor"></a><code><span>| </span></code><code><span>`DuplicatePoints</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Raised during polygon validation if there are any duplicate points across all of the paths contained within <a href="#type-t"><code>t</code></a>.</p><span class="comment-delim">*)</span></td></tr></table><code><span> ]</span></code></div></div><div class="odoc-spec"><div class="spec exception" id="exception-InvalidPoly" class="anchored"><a href="#exception-InvalidPoly" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">InvalidPoly</span> <span class="keyword">of</span> <a href="#type-invalid">invalid</a></span></code></div><div class="spec-doc"><p>Exception raised on validation failure (see <a href="#type-invalid"><code>invalid</code></a> for reasons)</p></div></div><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span><span> = <span class="keyword">private</span> </span><span>{</span></code><table><tr id="type-t.outer" class="anchored"><td class="def record field"><a href="#type-t.outer" class="anchor"></a><code><span>outer : <a href="../Path2/index.html#type-t">Path2.t</a>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>outer perimeter</p><span class="comment-delim">*)</span></td></tr><tr id="type-t.holes" class="anchored"><td class="def record field"><a href="#type-t.holes" class="anchor"></a><code><span>holes : <span><a href="../Path2/index.html#type-t">Path2.t</a> list</span>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>inner paths to be subtracted from the outer shape</p><span class="comment-delim">*)</span></td></tr></table><code><span>}</span></code></div><div class="spec-doc"><p>2-dimensional polygon</p><p>This type is kept private to force use of <a href="#val-make"><code>make</code></a>, which performs <a href="#val-validation"><code>validation</code></a> by default, hopefully providing an early warning that the shape may have issues rendering in a CAD backend.</p></div></div><h2 id="creation-and-validation"><a href="#creation-and-validation" class="anchor"></a>Creation and Validation</h2><div class="odoc-spec"><div class="spec value" id="val-make" class="anchored"><a href="#val-make" class="anchor"></a><code><span><span class="keyword">val</span> make : <span>?validate:bool <span class="arrow">&#45;&gt;</span></span> <span>?holes:<span><a href="../Path2/index.html#type-t">Path2.t</a> list</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="../Path2/index.html#type-t">Path2.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>make ?validate ?holes outer</code></p><p>Create a 2d polygon from an <code>outer</code> path (perimeter), and zero or more <code>holes</code> (default = <code>[]</code>). If validate is <code>true</code> (as it is by default), <a href="#val-validation"><code>validation</code></a> is performed, raising exceptions if the defined polygon is not simple (and thus, may cause problems in CGAL).</p></div></div><div class="odoc-spec"><div class="spec value" id="val-add_holes" class="anchored"><a href="#val-add_holes" class="anchor"></a><code><span><span class="keyword">val</span> add_holes : <span>?validate:bool <span class="arrow">&#45;&gt;</span></span> <span>holes:<span><span><a href="../V2/index.html#type-t">V2.t</a> list</span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>add_holes ?validate ~holes t</code></p><p>Add <code>holes</code> to <code>t</code>. If validate is <code>true</code> (as it is by default), <a href="#val-validation"><code>validation</code></a> is performed, raising exceptions if the defined polygon is not simple (and thus, may cause problems in CGAL).</p></div></div><div class="odoc-spec"><div class="spec value" id="val-validation" class="anchored"><a href="#val-validation" class="anchor"></a><code><span><span class="keyword">val</span> validation : <span>?eps:float <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>validation ?eps t</code></p><p>Validate that <code>t</code> is a legal polygon, without self-intersections within paths, cross-intersections between paths, or any duplicate points. All checks are performed with the tolerance <code>eps</code>. If valid, unit will be returned, otherwise an exception will be raised.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <span class="value">InvalidPoly</span> <p>if any paths in <code>t</code> self-intersect, there are cross-intersections between them, or if there are duplicate points.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-is_simple" class="anchored"><a href="#val-is_simple" class="anchor"></a><code><span><span class="keyword">val</span> is_simple : <span>?eps:float <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>is_simple ?eps t</code></p><p>Return <code>true</code> if <code>t</code> is a simple polygon, without self-intersections within paths, cross-intersections between paths, or any duplicate points. All checks are performed with the tolerance <code>eps</code>.</p></div></div><h2 id="basic-shapes"><a href="#basic-shapes" class="anchor"></a>Basic Shapes</h2><div class="odoc-spec"><div class="spec value" id="val-circle" class="anchored"><a href="#val-circle" class="anchor"></a><code><span><span class="keyword">val</span> circle : <span>?fn:int <span class="arrow">&#45;&gt;</span></span> <span>?fa:float <span class="arrow">&#45;&gt;</span></span> <span>?fs:float <span class="arrow">&#45;&gt;</span></span> <span>float <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>circle ?fn ?fa ?fs r</code></p><p>Create a circle of radius <code>r</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-wedge" class="anchored"><a href="#val-wedge" class="anchor"></a><code><span><span class="keyword">val</span> wedge : 
  <span>?fn:int <span class="arrow">&#45;&gt;</span></span>
  <span>?fa:float <span class="arrow">&#45;&gt;</span></span>
  <span>?fs:float <span class="arrow">&#45;&gt;</span></span>
  <span>centre:<a href="../V2/index.html#type-t">V2.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>radius:float <span class="arrow">&#45;&gt;</span></span>
  <span>start:float <span class="arrow">&#45;&gt;</span></span>
  <span>float <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>wedge ?fn ?fa ?fs ~centre ~radius ~start a</code></p><p>Create an arcing path (as in <a href="../Path2/index.html#val-arc"><code>Path2.arc</code></a>), with the <code>centre</code> point included to close the path, forming a wedge.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-square" class="anchored"><a href="#val-square" class="anchor"></a><code><span><span class="keyword">val</span> square : <span>?center:bool <span class="arrow">&#45;&gt;</span></span> <span><a href="../V2/index.html#type-t">V2.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>square ?center dims</code></p><p>Create a rectangular polygon with xy <code>dims</code> (e.g. width and height). If <code>center</code> is <code>true</code> then the path will be centred around the origin (default = <code>false</code>).</p></div></div><div class="odoc-spec"><div class="spec value" id="val-ellipse" class="anchored"><a href="#val-ellipse" class="anchor"></a><code><span><span class="keyword">val</span> ellipse : <span>?fn:int <span class="arrow">&#45;&gt;</span></span> <span>?fa:float <span class="arrow">&#45;&gt;</span></span> <span>?fs:float <span class="arrow">&#45;&gt;</span></span> <span><a href="../V2/index.html#type-t">V2.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>ellipse ?fn ?fa ?fs radii</code></p><p>Draw an ellipse with xy <code>radii</code>. The greater of the two radii is used for fragment/resolution calculation.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-star" class="anchored"><a href="#val-star" class="anchor"></a><code><span><span class="keyword">val</span> star : <span>r1:float <span class="arrow">&#45;&gt;</span></span> <span>r2:float <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>star ~r1 ~r2 n</code></p><p>Draw an <code>n</code> pointed star with inner radius <code>r1</code> and outer radius <code>r2</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-ring" class="anchored"><a href="#val-ring" class="anchor"></a><code><span><span class="keyword">val</span> ring : <span>?fn:int <span class="arrow">&#45;&gt;</span></span> <span>?fa:float <span class="arrow">&#45;&gt;</span></span> <span>?fs:float <span class="arrow">&#45;&gt;</span></span> <span>thickness:<a href="../V2/index.html#type-t">V2.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../V2/index.html#type-t">V2.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>ring ?fn ?fa ?fs ~thickness radii</code></p><p>Draw an empty elliptical ring of outer xy <code>radii</code>, with the given radial <code>thickness</code> (difference between outer and inner radii). For a circular ring, use equal x and y radii.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-box" class="anchored"><a href="#val-box" class="anchor"></a><code><span><span class="keyword">val</span> box : <span>?center:bool <span class="arrow">&#45;&gt;</span></span> <span>thickness:<a href="../V2/index.html#type-t">V2.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../V2/index.html#type-t">V2.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>box ?center ~thickness dims</code></p><p>Create a rectangular empty box of outer xy dimensions <code>dims</code>, with the given xy <code>thickness</code> (difference between outer and inner xy dimensions). If <code>center</code> is <code>true</code>, then the path will be centred around the origin (default = <code>false</code>).</p></div></div><h2 id="geometry"><a href="#geometry" class="anchor"></a>Geometry</h2><div class="odoc-spec"><div class="spec value" id="val-bbox" class="anchored"><a href="#val-bbox" class="anchor"></a><code><span><span class="keyword">val</span> bbox : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../V2/index.html#type-bbox">V2.bbox</a></span></code></div><div class="spec-doc"><p><code>bbox t</code></p><p>Compute the 2d bounding box of the polygon <code>t</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-centroid" class="anchored"><a href="#val-centroid" class="anchor"></a><code><span><span class="keyword">val</span> centroid : <span>?eps:float <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../V2/index.html#type-t">V2.t</a></span></code></div><div class="spec-doc"><p><code>centroid ?eps t</code></p><p>Compute the centroid of the outer path of the polygon <code>t</code>. If <code>t.outer</code> is collinear or self-intersecting (within <code>eps</code> tolerance), an <code>Invalid_argument</code> exception is raised.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-area" class="anchored"><a href="#val-area" class="anchor"></a><code><span><span class="keyword">val</span> area : <span>?signed:bool <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> float</span></code></div><div class="spec-doc"><p><code>area ?signed t</code></p><p>Compute the total area of the polygon <code>t</code>. If <code>signed</code> is <code>true</code>, then the signed areas of the <code>outer</code> and <code>holes</code> paths of <code>t</code> will be summed (keep in mind that this is dependent on winding direction, which should generally be opposite between outer and inner paths), otherwise the unsigned (positive) area of the <code>holes</code> will be subtracted (default = <code>false</code>).</p></div></div><h2 id="offset-and-basic-transformations"><a href="#offset-and-basic-transformations" class="anchor"></a>Offset and Basic Transformations</h2><div class="odoc-spec"><div class="spec value" id="val-offset" class="anchored"><a href="#val-offset" class="anchor"></a><code><span><span class="keyword">val</span> offset : 
  <span>?fn:int <span class="arrow">&#45;&gt;</span></span>
  <span>?fs:float <span class="arrow">&#45;&gt;</span></span>
  <span>?fa:float <span class="arrow">&#45;&gt;</span></span>
  <span>?check_valid:<span>[ <span>`Quality of int</span> <span>| `No</span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?mode:<span>[&lt; `Chamfer <span>| `Delta</span> <span>| `Radius</span> Delta ]</span> <span class="arrow">&#45;&gt;</span></span>
  <span>float <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>offset ?fn ?fs ?fa ?check_valid ?mode d t</code></p><p>Offset outer and inner paths of <code>t</code> by the specified distance <code>d</code>. The <code>mode</code> governs how <code>d</code> is used to create the new corners.</p><ul><li><code>`Delta</code> will create a new outline whose sides are a fixed distance <code>d</code> (+ve out, -ve in) from the original outline (this is the default behaviour).</li><li><code>`Chamfer</code> fixed distance offset by <code>d</code> as with delta, but with corners chamfered.</li><li><code>`Radius</code> creates a new outline as if a circle of some radius <code>d</code> is rotated around the exterior (<code>d &gt; 0</code>) or interior (<code>d &lt; 0</code>) original outline. <code>fn</code>, <code>fs</code>, and <code>fa</code> parameters govern the number of points that will be used for these arcs (they are ignored for delta and chamfer modes).</li><li>The <code>check_valid</code> default of <code>`Quality 1</code> will check the validity of shifted line segments by checking whether their ends and <code>n</code> additional points spaced throughout are far enough from the original path. If there are no points that have been offset by the target <code>d</code>, a <code>Failure</code> exception will be raised. Checking can be turned off by setting this to <code>`No</code>.</li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-map" class="anchored"><a href="#val-map" class="anchor"></a><code><span><span class="keyword">val</span> map : <span><span>( <span><a href="../Path2/index.html#type-t">Path2.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../Path2/index.html#type-t">Path2.t</a> )</span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>map f t</code></p><p>Map the outer and inner paths of <code>t</code> with the function <code>f</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-translate" class="anchored"><a href="#val-translate" class="anchor"></a><code><span><span class="keyword">val</span> translate : <span><a href="../V2/index.html#type-t">V2.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-xtrans" class="anchored"><a href="#val-xtrans" class="anchor"></a><code><span><span class="keyword">val</span> xtrans : <span>float <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-ytrans" class="anchored"><a href="#val-ytrans" class="anchor"></a><code><span><span class="keyword">val</span> ytrans : <span>float <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-rotate" class="anchored"><a href="#val-rotate" class="anchor"></a><code><span><span class="keyword">val</span> rotate : <span>?about:<a href="../V2/index.html#type-t">V2.t</a> <span class="arrow">&#45;&gt;</span></span> <span>float <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-zrot" class="anchored"><a href="#val-zrot" class="anchor"></a><code><span><span class="keyword">val</span> zrot : <span>?about:<a href="../V2/index.html#type-t">V2.t</a> <span class="arrow">&#45;&gt;</span></span> <span>float <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-scale" class="anchored"><a href="#val-scale" class="anchor"></a><code><span><span class="keyword">val</span> scale : <span><a href="../V2/index.html#type-t">V2.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-xscale" class="anchored"><a href="#val-xscale" class="anchor"></a><code><span><span class="keyword">val</span> xscale : <span>float <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-yscale" class="anchored"><a href="#val-yscale" class="anchor"></a><code><span><span class="keyword">val</span> yscale : <span>float <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-mirror" class="anchored"><a href="#val-mirror" class="anchor"></a><code><span><span class="keyword">val</span> mirror : <span><a href="../V2/index.html#type-t">V2.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-affine" class="anchored"><a href="#val-affine" class="anchor"></a><code><span><span class="keyword">val</span> affine : <span><a href="../Affine2/index.html#type-t">Affine2.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div></div></div></body></html>